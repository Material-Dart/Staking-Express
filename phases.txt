### PHASE 1 PROMPT â€” Project Setup & Architecture (tamamlandÄ±: 28.1.26)

You are Claude Sonnet 4.5 acting as a **senior Solana blockchain architect and Rust engineer**.

We are building a production-grade staking protocol called **â€œStaking Expressâ€** using a **single monorepo** that contains:

* `/program` â†’ Anchor Solana smart contract
* `/frontend` â†’ React + Next.js frontend

In this phase, you must:

---

## 1. Repository Layout (Strict)

Design the repository with this exact structure:

```
staking-express/
â”‚
â”œâ”€â”€ program/
â”‚   â”œâ”€â”€ Anchor.toml
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ programs/
â”‚   â”‚   â””â”€â”€ staking_express/
â”‚   â”‚       â”œâ”€â”€ src/
â”‚   â”‚       â”‚   â”œâ”€â”€ lib.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ initialize.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ stake.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ unstake.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ claim_rewards.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ bonus_pool.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ referral.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ state.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ helpers.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ fees.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ math.rs
â”‚   â”‚       â”‚   â”œâ”€â”€ events.rs
â”‚   â”‚       â”‚   â””â”€â”€ errors.rs
â”‚   â”‚
â”‚   â””â”€â”€ tests/
â”‚
â”œâ”€â”€ frontend/
â”‚
â””â”€â”€ .github/workflows/
```

Explain:

* Why a monorepo is used
* How Anchor builds inside `/program`
* How the IDL will later be shared with `/frontend`

---

## 2. Toolchain & Build Configuration

Configure:

* Anchor framework
* Rust edition fixed to **2021** to avoid the `edition2024` build error

Provide and explain:

* `program/Cargo.toml`
* `program/Anchor.toml`

Explain:

* Why edition 2021 avoids the error
* Version pinning strategy

---

## 3. Program Entry Architecture

Implement and explain:

* `lib.rs` with module declarations and instruction routing
* Empty scaffolding files for:

  * `initialize.rs`
  * `stake.rs`
  * `unstake.rs`
  * `claim_rewards.rs`
  * `bonus_pool.rs`
  * `referral.rs`
  * `state.rs`
  * `helpers.rs`
  * `fees.rs`
  * `math.rs`
  * `events.rs`
  * `errors.rs`

Do NOT implement business logic yet â€” only:

* Program skeleton
* Module wiring
* Compilation-ready structure

Explain every fileâ€™s purpose and how Anchor dispatch works.

---

## 4. High-Level System Design (No Code Yet)

Before ending this phase, explain:

* All on-chain accounts we will need
* PDA strategy
* Authority model
* How staking, bonus pool, and referral systems will interact

---

### Output Rules

* Explain everything clearly
* Produce compiling scaffolding code
* End with a short summary and wait for me to say **â€œProceed to Phase 2â€**

---

---

## ğŸ”¹ PHASE 2 â€” Core State & Fee Engine (tamamlandÄ±: 29.1.26)

**Goal:** Implement accounts, fee math, and staking core.

I will give you this when youâ€™re ready:

* All on-chain state structs
* Fee calculation engine (10% logic)
* Treasury routing
* Reward accounting base

---

## ğŸ”¹ PHASE 3 â€” Staking / Unstaking Instructions (tamamlandÄ±: 29.1.26)

**Goal:**

* Implement `stake.rs` and `unstake.rs`
* Full fee flow
* Reward distribution engine
* Events

---

## ğŸ”¹ PHASE 4 â€” Bonus Pool System (tamamlandÄ±: 29.1.26)

**Goal:**

* Countdown timer
* Last-10 investors list
* Bonus distribution logic
* Safety against race conditions

---

## ğŸ”¹ PHASE 5 â€” Referral System (tamamlandÄ±: 29.1.26)

**Goal:**

* Instant referral reward
* Referral reward pool
* Monthly scheduler & distribution

---

## ğŸ”¹ PHASE 6 â€” Testing (Anchor + TypeScript + Mocha)

**Goal:**

* Full integration test suite
* Fee correctness
* Bonus logic tests
* Edge cases

---

## ğŸ”¹ PHASE 7 â€” CI (GitHub Actions + Radar)

**Goal:**

* `.github/workflows/ci.yml`
* Formatting, linting, build, test
* Radar static analysis integration

---

## ğŸ”¹ PHASE 8 â€” Frontend Integration (Next.js)

**Goal:**

* Wallet adapter
* IDL import from `/program`
* PDA reads
* Live dashboard values

---

## ğŸ”¹ PHASE 9 â€” Deployment & Hosting

**Goal:**

* Devnet deployment
* Upgrade authority
* Frontend hosting options
* Production checklist